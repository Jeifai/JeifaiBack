{{ define "content" }}
    <div id="app">
        <h1>
            Your matches
        </h1>
        <div>
            <label id="Filter" for="Filter" class="mdc-text-field mdc-text-field--filled mdc-text-field--with-leading-icon">
                <i class="material-icons mdc-text-field__icon mdc-text-field__icon--leading" tabindex="0" role="button">text_fields</i>
                <input class="mdc-text-field__input" type="text" aria-labelledby="Filter" v-model="filter">
                <span class="mdc-floating-label" id="Filter">Filter by any field</span>
                <div class="mdc-line-ripple"></div>
            </label>
        </div>
        <div class="mdc-data-table">
            <table class="mdc-data-table__table" aria-label="Created Keywords">
                <thead>
                    <tr class="mdc-data-table__header-row">
                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">CreatedAt</th>
                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Target</th>
                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Job Title</th>
                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Job Url</th>
                    </tr>
                </thead>
                <tbody class="mdc-data-table__content">
                    <tr v-for="(row, index) in filteredRows" class="mdc-data-table__row">
                        <td class="mdc-data-table__cell" v-html="row.CreatedDate"></td>
                        <td class="mdc-data-table__cell" v-html="row.Target"></td>
                        <td class="mdc-data-table__cell" v-html="row.Title"></td>
                        <td class="mdc-data-table__cell">
                            <button 
                                class="material-icons mdc-top-app-bar__action-item mdc-icon-button" 
                                aria-label="Open"
                                target="_blank" 
                                rel="noopener"
                                v-on:click="select(row)">open_in_new
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <script>
        new Vue({
            el: '#app',
            delimiters: ["[[","]]"],
            data: {
                filter: '',
                results: {{.Data}},
            },
            methods: {
                select: function(raw) {
                    window.open(raw.Url, "_blank");
                }
            },
            computed: {
                filteredRows() {
                    return this.results.filter(row => {
                        const CreatedDate = row.CreatedDate.toString().toLowerCase();
                        const Target = row.Target.toString().toLowerCase();
                        const Title = row.Title.toString().toLowerCase();
                        const searchTerm = this.filter.toLowerCase();
                        return (
                            CreatedDate.includes(searchTerm) || Target.includes(searchTerm) || Title.includes(searchTerm)
                        );
                    });
                }
            }
        })
    </script>
    <script type="module">
        const dataTable = mdc.dataTable.MDCDataTable.attachTo(document.querySelector('.mdc-data-table'));
        const textFilter= mdc.textField.MDCTextField.attachTo(document.getElementById("Filter"));
    </script>
    <style>
        @use "@material/checkbox"; // Required only for data table with row selection.
        @use "@material/data-table";
        @include checkbox.core-styles;
        @include data-table.core-styles;
    </style>
{{ end }}